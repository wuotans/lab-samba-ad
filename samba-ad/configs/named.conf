// BIND Configuration for Samba AD
options {
    directory "/var/cache/bind";
    
    // Listen on all interfaces
    listen-on { any; };
    listen-on-v6 { any; };
    
    // Allow queries from anywhere
    allow-query { any; };
    allow-query-cache { any; };
    
    // Recursion settings
    recursion yes;
    allow-recursion { any; };
    
    // Forwarders
    forwarders {
        8.8.8.8;
        8.8.4.4;
    };
    forward only;
    
    // Security
    allow-transfer { none; };
    allow-update { localhost; };
    
    // DNSSEC
    dnssec-validation auto;
    dnssec-enable yes;
    
    // Rate limiting
    rate-limit {
        responses-per-second 10;
        window 5;
    };
    
    // Logging
    version "not disclosed";
    
    // Statistics
    statistics-file "/var/log/bind/named.stats";
};

// Include Samba AD DLZ configuration
include "/var/lib/samba/private/named.conf";

// Zone definitions
zone "." {
    type hint;
    file "/usr/share/dns/root.hints";
};

zone "localhost" {
    type master;
    file "/etc/bind/db.local";
    allow-update { none; };
};

zone "127.in-addr.arpa" {
    type master;
    file "/etc/bind/db.127";
    allow-update { none; };
};

// Include local zones
include "/etc/bind/named.conf.local";

// Logging configuration
logging {
    channel default_log {
        file "/var/log/bind/named.log" versions 3 size 5m;
        severity info;
        print-time yes;
        print-category yes;
        print-severity yes;
    };
    channel query_log {
        file "/var/log/bind/query.log" versions 3 size 5m;
        severity info;
        print-time yes;
        print-category yes;
        print-severity yes;
    };
    category default { default_log; };
    category queries { query_log; };
    category security { default_log; };
    category config { default_log; };
    category resolver { default_log; };
};